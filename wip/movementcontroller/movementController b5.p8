pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--a small game by hero♥

playerx=60
playery=125
yvelocity=0
xvelocity=0
gravity=0.16
currentlevel=0
mapx=0
mapy=0
timer_frames=0
timer_seconds=0

--checking if the tile is collidable
function checkcollision(flag,gmode)
 tilecolumn=flr(playerx/8)
 if gmode==false then
  tilerow=flr(playery/8)
 elseif gmode==true then
  tilerow=flr((playery+1)/8)
 end
 
 spriteatplayer=mget(tilecolumn+mapx,tilerow+mapy)
 
 if fget(spriteatplayer,flag) then
  return true 
 else 
  return false 
 end
end

--check if on ground or solid tile
function ontile()
 if playery==125 then
  return 1
 --check if on up tile
 elseif checkcollision(1,true) then
  return 1
 --check if on left tile
 elseif checkcollision(2,true) then
  return 2
 --check if on right tile
 elseif checkcollision(3,true) then
  return 3
 --check if on down tile
 elseif checkcollision(4,true) then
  return 4
 --check if on exit tile
 elseif checkcollision(5,true) then
  return 5
 else
  return 0
 end
end

--reset and move to nxt lvl
function nextlevel()
 currentlevel+=1
 mapx+=16
 playerx=60
 playery=126
end

--runs every frame
function _update()
	--update timer
	
	if currentlevel!=0 then
		timer_frames+=1
		if timer_frames==30 then
			timer_seconds+=1
			timer_frames=0
		end
		if timer_seconds>=999 then
			timer_seconds=999
		end
	end

 --get player inputs
 if btn(0) then
  xvelocity-=0.2
 elseif btn(1) then
  xvelocity+=0.2
 else
 xvelocity*=0.05 end

 --set max velocities
 if xvelocity>2 then
  xvelocity=2 end
 if xvelocity<-2 then
  xvelocity=-2 end
 if yvelocity>10 then
  yvelocity=10 end
 if yvelocity<-10 then
  yvelocity=-10 end

 --keeping playery in bounds
 --temporary limit at 126 !!
 if playery>=126 then
  playery=126
 end
	
 --keeping playerx in bounds
 if playerx<2 then
  playerx=2 
  xvelocity*=0.01
 end
 if playerx>126 then
  playerx=126
  xvelocity*=0.01
 end
		
 --check spike collisions
 if checkcollision(0,false) then
  yvelocity=0
  xvelocity=0
  playerx=60
  playery=126
 end

 --check direction tiles
	
 --check if in up tile
 if ontile()==1 then
  playery-=2
  yvelocity=-1.25
 end
 --check if in left tile
 if ontile()==2 then
  playerx-=2
  playery-=0.1
  xvelocity=-1.25
  yvelocity=-0.5
 end
 --check if in right tile
 if ontile()==3 then
  playerx+=2
  playery-=0.1
  xvelocity=1.25
  yvelocity=-0.5
 end
 --check if in down tile
 if ontile()==4 then
  playery+=2.25
  yvelocity=1.25
 end
 --check if in exit tile
 if ontile()==5 then
  nextlevel()
 end
	
 --update movement
 yvelocity+=gravity
 playery+=yvelocity
 playerx+=xvelocity
end

--drawing on screen every frame
function _draw()
 cls(0)
 
 --rendering the level
 map(mapx,mapy,0,0,16,32)
 
 --display info on first level
 if currentlevel==0 then
 	print("⬅️ use arrows to move ➡️",15,2,6)
 	print("the tiles with arrows push you",5,10,6)
 end
 
 --display ui overlay
 if currentlevel!=0 then
  rectfill(1,1,21,13,1)
  print("level ",2,2,6)
  print(currentlevel)
  
  rectfill(114,1,126,7,1)
  print(timer_seconds,115,2,6)
 end
 
 --drawing player
 rectfill(playerx-1,playery-1,playerx+1,playery+1,9)
end

__gfx__
000000000cccccc00cccccc008888880033333300bbbbbb00dddddd0022222200000000010101010001100110000000000000000000000000000000000000000
00000000ccccccccccc66ccc86888868333b3333bbbb3bbbddd66ddd2eeeeee200ccc00c01010101001100110000000000000000000000000000000000000000
00700700cccccccccc6666cc8868868833b33333bbbbb3bbddd66ddd2eeeeee2cceeecce10101010110011000000000000000000000000000000000000000000
00077000ccccccccc6c66c6c888668883bbbbbb3b333333bddd66ddd2eeeeee2ee777ee701010101110011000000000000000000000000000000000000000000
00077000ccccccccccc66ccc888668883bbbbbb3b333333bd6d66d6d2eeeeee277eee77e10101010001100110000000000000000000000000000000000000000
00700700ccccccccccc66ccc8868868833b33333bbbbb3bbdd6666dd2eeeeee2eeccceec01010101001100110000000000000000000000000000000000000000
00000000ccccccccccc66ccc86888868333b3333bbbb3bbbddd66ddd2eeeeee2cc000cc010101010110011000000000000000000000000000000000000000000
00000000cccccccc0cccccc008888880033333300bbbbbb00dddddd0022222200000000001010101110011000000000000000000000000000000000000000000
__gff__
0002020104081020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000090000000000000000000000000000000000000000000000000900000000000000000300000000000900000000030009000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000090000000000000000090000000000000000000000000000000000000000000000000a09000a0a000000000300000000090a00000000030900090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000a0900000000000000090000000000000a000000000307040400020000000000000007070009090000000003000000000a0900000000030603030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000090a0000090000000703000000000000090a000000000300000002000000000000000202000a0a000000000306040400090a00000000030609030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00030000000a0900090a00000002030000000000000a0900000000030000000200000900000000020200090900000000030603030303020000000003060a030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000300000a090a000a090a0000020300000905050505050505000603000000020000090a0000000202000a0a000000000306030909030200000000030609030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0003020002020202020202020202030009000200000000000003060300000002000a0a0900090002020009090000000003060309090302000000000a090a030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00030200000009090000090000000300000902000a0000000003060300000002000203030302000900000203030302000306030909030000000204040409030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000302000000090900000a0000000a0009000200090a000000030603000a0002000200000000000009000000000002000306030303030303030303030303030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0003020000090a090000090000000900000902000a09000000030603000900020002000a0000000900000009000002000308080703000000000000000000030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0903020002020202020002000000090009000200090a000000030000090a000200020a09000000000900090a0900020a0302020803000000000000000000030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a030a00000000000000020000000a00000902020202020000030202020202020002090404040009000005050500020903030303030000000a0000000000030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09030900000000000000020900000a0009000009090a0200000300000000000000000a0900020000090002090a00090a030a090900000000090a00000009030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0000090a000000020a00000900000900090a09020000030009000000090000090a000200090000020a09000a090309090a000000000a090000000a030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09090900000a0909000002090a0009000900000a090902000003000a0900090a00000a0900020400090502090a00090a030a09090000000a090a000000090a0200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101
