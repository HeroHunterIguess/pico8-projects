pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
playerx=60
playery=126
yvelocity=0
xvelocity=0
gravity=0.15


--checking if the tile is collidable
function checkcollision(flag,gmode)
	tilecolumn = flr(playerx/8)
	if gmode==false then
 	tilerow = flr(playery/8)
 elseif gmode==true then
 	tilerow = flr((playery+1)/8)
 end
 
 spriteatplayer = mget(tilecolumn,tilerow)
 
 if fget(spriteatplayer,flag) then
 	return true 
 else return false end
end

--check if on ground or solid tile
function ontile()
 if playery==126 then
  return true
 --check if on groud w/ tile col
 elseif checkcollision(1,true) then
 	return true
 else
 	return false
 end
end

--runs every frame
function _update()
	--get player inputs
	if btn(0) then
	 xvelocity-=0.2
	elseif btn(1) then
		xvelocity+=0.2
	else
		xvelocity*=0.05end
  
	--set max velocities
	if xvelocity>2 then
	 xvelocity=2end
	if xvelocity<-2 then
		xvelocity=-2end
	if yvelocity>10 then
		yvelocity=10end
	if yvelocity<-10 then
		yvelocity=-10end
	
	--keeping player in bounds	
	if playery >= 126 then
		playery = 126 end
		
	if playerx < 0 then
		playerx=0 end
	if playerx > 126 then
		playerx=126 end
		
	--check spike collisions
	if checkcollision(0,false) then
		yvelocity=0
		xvelocity=0
		playerx=60
		playery=126
	end
	
	--check if in tile
	if ontile() then
		playery-=2.25
		yvelocity=0
	end
	
	--update movement
	yvelocity+=gravity
	playery+=yvelocity
	playerx+=xvelocity
end

--drawing on screen every frame
function _draw()
	cls(0)
	map(0, 0, 0, 0, 32, 32)
	rectfill(playerx-1,playery-1,playerx+1,playery+1,9)
end

__gfx__
0000000000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000cccccccc88888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000020100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0200000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000002020000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000020200000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000200020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030000000000020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202000000020000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000030002020000020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000002020002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000030303000000020002020203030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
