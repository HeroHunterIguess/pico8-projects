pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--a small game by heroâ™¥

playerx=60
playery=126
yvelocity=0
xvelocity=0
gravity=0.16
currentlevel=0
mapx=0
mapy=0

--checking if the tile is collidable
function checkcollision(flag,gmode)
 tilecolumn=flr(playerx/8)
 if gmode==false then
  tilerow=flr(playery/8)
 elseif gmode==true then
  tilerow=flr((playery+1)/8)
 end
 
 spriteatplayer=mget(tilecolumn+mapx,tilerow+mapy)
 
 if fget(spriteatplayer,flag) then
  return true 
 else 
  return false 
 end
end

--check if on ground or solid tile
function ontile()
 if playery==126 then
  return 1
 --check if on up tile
 elseif checkcollision(1,true) then
  return 1
 --check if on left tile
 elseif checkcollision(2,true) then
  return 2
 --check if on right tile
 elseif checkcollision(3,true) then
  return 3
 --check if on down tile
 elseif checkcollision(4,true) then
  return 4
 --check if on exit tile
 elseif checkcollision(5,true) then
  return 5
 else
  return 0
 end
end

--reset and move to nxt lvl
function nextlevel()
 currentlevel+=1
 mapx+=16
 playerx=60
 playery=126
end

--runs every frame
function _update()
 --get player inputs
 if btn(0) then
  xvelocity-=0.2
 elseif btn(1) then
  xvelocity+=0.2
 else
 xvelocity*=0.05 end

 --set max velocities
 if xvelocity>2 then
  xvelocity=2 end
 if xvelocity<-2 then
  xvelocity=-2 end
 if yvelocity>10 then
  yvelocity=10 end
 if yvelocity<-10 then
  yvelocity=-10 end

 --keeping playery in bounds
 --temporary limit at 126 !!
 if playery >= 126 then
  playery = 126
 end
	
 --keeping playerx in bounds
 if playerx<2 then
  playerx=minx
  xvelocity*=0.01
 end
 if playerx>126 then
  playerx=maxx
  xvelocity*=0.01
 end
		
 --check spike collisions
 if checkcollision(0,false) then
  yvelocity=0
  xvelocity=0
  playerx=60
  playery=126
 end

 --check direction tiles
	
 --check if in up tile
 if ontile()==1 then
  playery-=2
  yvelocity=-1.25
 end
 --check if in left tile
 if ontile()==2 then
  playerx-=2
  playery-=0.1
  xvelocity=-1.25
  yvelocity=-0.5
 end
 --check if in right tile
 if ontile()==3 then
  playerx+=2
  playery-=0.1
  xvelocity=1.25
  yvelocity=-0.5
 end
 --check if in down tile
 if ontile()==4 then
  playery+=2.25
  yvelocity=1.25
 end
 --check if in exit tile
 if ontile()==5 then
  nextlevel()
 end
	
 --update movement
 yvelocity+=gravity
 playery+=yvelocity
 playerx+=xvelocity
end

--drawing on screen every frame
function _draw()
 cls(0)
 
 --rendering the level
 map(mapx,mapy,0,0,16,32)
 
 --drawing player
 rectfill(playerx-1,playery-1,playerx+1,playery+1,9)
end

__gfx__
000000001cccccc11cccccc118888881133333311bbbbbb11dddddd1122222211111111100000000000000000000000000000000000000000000000000000000
00000000ccccccccccc66ccc8688886833363333bbbb6bbbddd66ddd2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00700700cccccccccc6666cc8868868833633333bbbbb6bbddd66ddd2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00077000ccccccccc6c66c6c8886688836666663b666666bddd66ddd2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00077000ccccccccccc66ccc8886688836666663b666666bd6d66d6d2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00700700ccccccccccc66ccc8868868833633333bbbbb6bbdd6666dd2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00000000ccccccccccc66ccc8688886833363333bbbb6bbbddd66ddd2eeeeee21111111100000000000000000000000000000000000000000000000000000000
00000000cccccccc1cccccc118888881133333311bbbbbb11dddddd1122222211111111100000000000000000000000000000000000000000000000000000000
__gff__
0002020104081020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0808080808080808080808080808080303080808080808080808080808080808080000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080808080808080303080808080808080808080808080807030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080708080808080808080808080303080808080808080808080808080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808020805050505080808080608080303080808080808080808080808080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808020202080808080808080608080303080808080808080808080806080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202080202080804040208080608080303080505050505050505050506080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080802020808080208080608080303080802080808080808080806080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808020208080208080608080303080802080808080808080806080802030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080208020208080608080303080802080808080808080505050502030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030808080808020208080808080303080802040404040404080808080808030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202080808020808080808080303080802080808080208080808080808030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808030802020808020208080303080808080808080208080808080808030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080802020802020808080808080303080808080808080208080808080808030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080202020808080808080808080808080808080802080808080808000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808020808080808080808080808080808080802080808080808000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
